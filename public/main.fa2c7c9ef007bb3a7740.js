/*! For license information please see main.fa2c7c9ef007bb3a7740.js.LICENSE.txt */
(()=>{"use strict";function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(n)}function n(){var t,i,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.toStringTag||"@@toStringTag";function a(n,r,o,s){var a=r&&r.prototype instanceof u?r:u,l=Object.create(a.prototype);return e(l,"_invoke",function(n,e,r){var o,s,a,u=0,l=r||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return o=n,s=0,a=t,d.n=e,c}};function p(n,e){for(s=n,a=e,i=0;!f&&u&&!r&&i<l.length;i++){var r,o=l[i],p=d.p,m=o[2];n>3?(r=m===e)&&(a=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=p&&((r=n<2&&p<o[1])?(s=0,d.v=e,d.n=o[1]):p<m&&(r=n<3||o[0]>e||e>m)&&(o[4]=n,o[5]=e,d.n=m,s=0))}if(r||n>1)return c;throw f=!0,e}return function(r,l,m){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&p(l,m),s=l,a=m;(i=s<2?t:a)||!f;){o||(s?s<3?(s>1&&(d.n=-1),p(s,a)):d.n=a:d.v=a);try{if(u=2,o){if(s||(r="next"),i=o[r]){if(!(i=i.call(o,a)))throw TypeError("iterator result is not an object");if(!i.done)return i;a=i.value,s<2&&(s=0)}else 1===s&&(i=o.return)&&i.call(o),s<2&&(a=TypeError("The iterator does not provide a '"+r+"' method"),s=1);o=t}else if((i=(f=d.n<0)?a:n.call(e,d))!==c)break}catch(n){o=t,s=1,a=n}finally{u=1}}return{value:i,done:f}}}(n,o,s),!0),l}var c={};function u(){}function l(){}function f(){}i=Object.getPrototypeOf;var d=[][o]?i(i([][o]())):(e(i={},o,function(){return this}),i),p=f.prototype=u.prototype=Object.create(d);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,s,"GeneratorFunction")),t.prototype=Object.create(p),t}return l.prototype=f,e(p,"constructor",f),e(f,"constructor",l),l.displayName="GeneratorFunction",e(f,s,"GeneratorFunction"),e(p),e(p,s,"Generator"),e(p,o,function(){return this}),e(p,"toString",function(){return"[object Generator]"}),(n=function(){return{w:a,m}})()}function e(t,n,i,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}e=function(t,n,i,r){function s(n,i){e(t,n,function(t){return this._invoke(n,i,t)})}n?o?o(t,n,{value:i,enumerable:!r,configurable:!r,writable:!r}):t[n]=i:(s("next",0),s("throw",1),s("return",2))},e(t,n,i,r)}function i(t,n,e,i,r,o,s){try{var a=t[o](s),c=a.value}catch(t){return void e(t)}a.done?n(c):Promise.resolve(c).then(i,r)}function r(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var s=t.apply(n,e);function a(t){i(s,r,o,a,c,"next",t)}function c(t){i(s,r,o,a,c,"throw",t)}a(void 0)})}}function o(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s(i.key),i)}}function s(n){var e=function(n){if("object"!=t(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var i=e.call(n,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==t(e)?e:e+""}var a=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.deltaTimerConfig=null,this.subscriptionConfig=null,this.init()},e=[{key:"init",value:(c=r(n().m(function t(){return n().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.loadConfigurations();case 1:this.setupEventListeners(),this.updateUI(),this.updateStatus();case 2:return t.a(2)}},t,this)})),function(){return c.apply(this,arguments)})},{key:"loadConfigurations",value:(a=r(n().m(function t(){var e,i,r;return n().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,fetch("/plugins/signalk-data-connector/config/delta_timer.json");case 1:return e=t.v,t.n=2,e.json();case 2:return this.deltaTimerConfig=t.v,t.n=3,fetch("/plugins/signalk-data-connector/config/subscription.json");case 3:return i=t.v,t.n=4,i.json();case 4:this.subscriptionConfig=t.v,t.n=6;break;case 5:t.p=5,r=t.v,this.showNotification("Error loading configurations: "+r.message,"error");case 6:return t.a(2)}},t,this,[[0,5]])})),function(){return a.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var t=this;document.getElementById("saveDeltaTimer").addEventListener("click",function(){t.saveDeltaTimer()}),document.getElementById("saveSubscription").addEventListener("click",function(){t.saveSubscription()}),document.getElementById("addPath").addEventListener("click",function(){t.addPathItem()}),document.getElementById("subscriptionJson").addEventListener("input",function(n){t.syncFromJson()}),document.getElementById("context").addEventListener("input",function(){t.updateJsonFromForm()})}},{key:"updateUI",value:function(){var t=this;this.deltaTimerConfig&&this.deltaTimerConfig.deltaTimer&&(document.getElementById("deltaTimer").value=this.deltaTimerConfig.deltaTimer),this.subscriptionConfig&&(document.getElementById("context").value=this.subscriptionConfig.context||"*",document.getElementById("pathsList").innerHTML="",this.subscriptionConfig.subscribe&&Array.isArray(this.subscriptionConfig.subscribe)&&this.subscriptionConfig.subscribe.forEach(function(n){t.addPathItem(n.path)}),document.getElementById("subscriptionJson").value=JSON.stringify(this.subscriptionConfig,null,2))}},{key:"addPathItem",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=document.getElementById("pathsList"),i=document.createElement("div");i.className="path-item",i.innerHTML='\n            <input type="text" value="'.concat(n,'" placeholder="navigation.position" class="path-input">\n            <button type="button" class="btn btn-danger" onclick="this.parentElement.remove(); window.dataConnectorConfig.updateJsonFromForm();">Remove</button>\n        '),i.querySelector(".path-input").addEventListener("input",function(){t.updateJsonFromForm()}),e.appendChild(i),this.updateJsonFromForm()}},{key:"updateJsonFromForm",value:function(){var t=document.getElementById("context").value||"*",n=document.querySelectorAll(".path-input"),e={context:t,subscribe:Array.from(n).map(function(t){return{path:t.value}}).filter(function(t){return""!==t.path.trim()})};document.getElementById("subscriptionJson").value=JSON.stringify(e,null,2)}},{key:"syncFromJson",value:function(){var t=this;try{var n=document.getElementById("subscriptionJson").value,e=JSON.parse(n);document.getElementById("context").value=e.context||"*",document.getElementById("pathsList").innerHTML="",e.subscribe&&Array.isArray(e.subscribe)&&e.subscribe.forEach(function(n){t.addPathItem(n.path||"")})}catch(t){console.warn("Invalid JSON in editor:",t.message)}}},{key:"saveDeltaTimer",value:(s=r(n().m(function t(){var e,i,r;return n().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e=parseInt(document.getElementById("deltaTimer").value),!(isNaN(e)||e<100||e>1e4)){t.n=1;break}return this.showNotification("Delta timer must be between 100 and 10000 milliseconds","error"),t.a(2);case 1:return i={deltaTimer:e},t.p=2,t.n=3,fetch("/plugins/signalk-data-connector/config/delta_timer.json",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});case 3:if(!t.v.ok){t.n=4;break}this.deltaTimerConfig=i,this.showNotification("Delta timer configuration saved successfully!","success"),this.updateStatus(),t.n=5;break;case 4:throw new Error("Failed to save configuration");case 5:t.n=7;break;case 6:t.p=6,r=t.v,this.showNotification("Error saving delta timer: "+r.message,"error");case 7:return t.a(2)}},t,this,[[2,6]])})),function(){return s.apply(this,arguments)})},{key:"saveSubscription",value:(i=r(n().m(function t(){var e,i,r;return n().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,e=document.getElementById("subscriptionJson").value,(i=JSON.parse(e)).context){t.n=1;break}throw new Error("Context is required");case 1:if(i.subscribe&&Array.isArray(i.subscribe)){t.n=2;break}throw new Error("Subscribe array is required");case 2:return t.n=3,fetch("/plugins/signalk-data-connector/config/subscription.json",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});case 3:if(!t.v.ok){t.n=4;break}this.subscriptionConfig=i,this.showNotification("Subscription configuration saved successfully!","success"),this.updateStatus(),t.n=5;break;case 4:throw new Error("Failed to save configuration");case 5:t.n=7;break;case 6:t.p=6,r=t.v,this.showNotification("Error saving subscription: "+r.message,"error");case 7:return t.a(2)}},t,this,[[0,6]])})),function(){return i.apply(this,arguments)})},{key:"updateStatus",value:function(){var t=document.getElementById("status"),n="<h4>Configuration Status</h4>";if(this.deltaTimerConfig?n+='\n                <div class="status-item">\n                    <strong>Delta Timer:</strong> '.concat(this.deltaTimerConfig.deltaTimer,'ms\n                    <span class="status-indicator success">✓ Configured</span>\n                </div>\n            '):n+='\n                <div class="status-item">\n                    <strong>Delta Timer:</strong> \n                    <span class="status-indicator warning">⚠ Not configured</span>\n                </div>\n            ',this.subscriptionConfig&&this.subscriptionConfig.subscribe){var e=this.subscriptionConfig.subscribe.length;n+='\n                <div class="status-item">\n                    <strong>Subscriptions:</strong> '.concat(e,' path(s) configured\n                    <span class="status-indicator success">✓ Configured</span>\n                </div>\n                <div class="status-details">\n                    <strong>Context:</strong> ').concat(this.subscriptionConfig.context,"<br>\n                    <strong>Paths:</strong> ").concat(this.subscriptionConfig.subscribe.map(function(t){return t.path}).join(", "),"\n                </div>\n            ")}else n+='\n                <div class="status-item">\n                    <strong>Subscriptions:</strong> \n                    <span class="status-indicator warning">⚠ Not configured</span>\n                </div>\n            ';t.innerHTML=n}},{key:"showNotification",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",e=document.getElementById("notification");e.textContent=t,e.className="notification ".concat(n," show"),setTimeout(function(){e.classList.remove("show")},4e3)}}],e&&o(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,i,s,a,c}();document.addEventListener("DOMContentLoaded",function(){window.dataConnectorConfig=new a})})();
//# sourceMappingURL=main.fa2c7c9ef007bb3a7740.js.map